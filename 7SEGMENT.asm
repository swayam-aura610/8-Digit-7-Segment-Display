ORG 0000H
LJMP MAIN
ORG 000BH ; Vectored Location of Timer 0
MOV TH0,#0F6H ; delay 2500usec
MOV TL0,#3CH
PUSH PSW 
PUSH ACC
CLR RS1
SETB RS0 ; RB1 selected
MOV P2,R2
MOV P0,@R0
INC R0
CJNE R0,#38H,L1
MOV R0,#30H
L1: MOV A,R2
RL A
MOV R2,A
POP ACC 
POP PSW
RETI
MAIN: MOV SP,#50H
MOV P1,#0FFH
MOV TMOD,#00000001B
MOV TH0,#0F6H
MOV TL0,#3CH
MOV 0AH,#0FEH 
MOV 08H,#30H
SETB TR0 
SETB ET0
SETB EA
PRESS:
MOV DPTR,#MSG0
LCALL D_MSG
MSG0: DB "NSUTECHO"
;STEADY MESSAGE 
KEY1: MOV A,P1
CJNE A,#0FEH,KEY2
LCALL DELAY
MOV A,P1
CJNE A,#0FEH,KEY2
K1: MOV DPTR,#MSG1
LCALL D_MSG
JNB P1.0,K1
JNB P1.1,S2 
JNB P1.2,S3 
JNB P1.3,S4 
JNB P1.4,S5 
JNB P1.5,S6 
JNB P1.6,S7
JNB P1.7,S8
SJMP K1
S2: LCALL KEY2 
S3: LCALL KEY3 
S4: LCALL KEY4 
S5: LCALL KEY5 
S6: LCALL KEY6
S7: LCALL KEY7 
S8: LCALL KEY8
;BLINKING MESSEGE
KEY2:
CJNE A,#0FDH,KEY3
LCALL DELAY
MOV A,P1
CJNE A,#0FDH,KEY3
K2: LCALL BLANK
LCALL DELAY2 ; 0.5SEC
MOV DPTR,#MSG1
LCALL D_MSG
LCALL DELAY2
JNB P1.0,S9
JNB P1.1,K2
JNB P1.2,S10 
JNB P1.3,S11 
JNB P1.4,S12 
JNB P1.5,S13 
JNB P1.6,S14
JNB P1.7,S15
SJMP K2
S9: LCALL KEY1
S10:LCALL KEY3 
S11:LCALL KEY4 
S12:LCALL KEY5 
S13:LCALL KEY6 
S14:LCALL KEY7
S15:LCALL KEY8
; Rolling through left
KEY3: CJNE A,#0FBH,KEY4
LCALL DELAY
MOV A,P1
CJNE A,#0FBH,KEY4
K3: MOV R3,#16
MOV DPTR,#MSG3
D1: LCALL D_MSG3 
LCALL DELAY2
INC DPTR
DJNZ R3,D1
JNB P1.0,S16
JNB P1.1,S17
JNB P1.2,K3
JNB P1.3,S18 
JNB P1.4,S19 
JNB P1.5,S20 
JNB P1.6,S21 
JNB P1.7,S22 
SJMP K3
S16:LCALL KEY1 
S17:LCALL KEY2 
S18:LCALL KEY4 
S19:LCALL KEY5 
S20:LCALL KEY6 
S21:LCALL KEY7
S22:LCALL KEY8
D_MSG3: PUSH DPH
PUSH DPL
MOV R0,#30H
B2: CLR A
MOVC A,@A+DPTR
CLR C
SUBB A,#30H
LCALL SEVSEG
MOV @R0,A
INC R0
INC DPTR
CJNE R0,#38H,B2
POP DPL
POP DPH
RET
;Rolling through right 
KEY4:
CJNE A,#0F7H,KEY5
LCALL DELAY
MOV A,P1
CJNE A,#0F7H,KEY5
K4: MOV R3,#16
MOV DPTR,#MSG4
D2: LCALL D_MSG4
LCALL DELAY2
INC DPTR
DJNZ R3,D2
JNB P1.0,S23 
JNB P1.1,S24
JNB P1.2,S25
JNB P1.3,K4
JNB P1.4,S26 
JNB P1.5,S27 
JNB P1.6,S28
JNB P1.7,S29
SJMP K4
S23: LCALL KEY1
S24: LCALL KEY2 
S25: LCALL KEY3 
S26: LCALL KEY5 
S27: LCALL KEY6 
S28: LCALL KEY7
S29: LCALL KEY8
D_MSG4: PUSH DPH
PUSH DPL
MOV R0,#37H
B3: CLR A
MOVC A,@A+DPTR
CLR C
SUBB A,#30H
LCALL SEVSEG
MOV @R0,A
DEC R0
INC DPTR
CJNE R0,#2FH,B3
POP DPL
POP DPH
RET
; Odd no LEDs blinking other’s steady 
KEY5:
CJNE A,#0EFH,KEY6
LCALL DELAY
MOV A,P1
CJNE A,#0EFH,KEY6
K5: MOV DPTR,#MSG1
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG5
LCALL D_MSG
LCALL DELAY2
JNB P1.0,S30 
JNB P1.1,S31 
JNB P1.2,S32
JNB P1.3,S33
JNB P1.4,K5
JNB P1.5,S34 
JNB P1.6,S35
JNB P1.7,S36
SJMP K5
S30:LCALL KEY1 
S31:LCALL KEY2 
S32:LCALL KEY3 
S33:LCALL KEY4 
S34:LCALL KEY6 
S35:LCALL KEY7
S36:LCALL KEY8
; Even LEDs blinking other’s steady
KEY6:
CJNE A,#0DFH,KEY7
LCALL DELAY
MOV A,P1
CJNE A,#0DFH,KEY7
K6: MOV DPTR,#MSG1
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG6
LCALL D_MSG
LCALL DELAY2
JNB P1.0,S37 
JNB P1.1,S38 
JNB P1.2,S39 
JNB P1.3,S40
JNB P1.4,S41
JNB P1.5,K6
JNB P1.6,S42
JNB P1.7,S43 
SJMP K6
S37:LCALL KEY1
S38:LCALL KEY2 
S39:LCALL KEY3 
S40:LCALL KEY4 
S41:LCALL KEY5 
S42:LCALL KEY7
S43:LCALL KEY8
; Rolling half message from outside to inside
KEY7:
CJNE A,#0BFH,KEY8
LCALL DELAY
MOV A,P1
CJNE A,#0BFH,KEY8
K7: MOV DPTR,#MSG9
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG10
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG11
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG12
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG13
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG14
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG15
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG16
LCALL D_MSG
LCALL DELAY2
JNB P1.0,S44 
JNB P1.1,S45 
JNB P1.2,S46 
JNB P1.3,S47 
JNB P1.4,S48
JNB P1.5,S49
JNB P1.6,K7
JNB P1.7,S50 
SJMP K7
S44:LCALL KEY1 
S45:LCALL KEY2 
S46:LCALL KEY3 
S47:LCALL KEY4 
S48:LCALL KEY5 
S49:LCALL KEY6 
S50:LCALL KEY8
; Rolling half message from inside to outside
KEY8:
CJNE A,#07FH,NOKEY 
LCALL DELAY
MOV A,P1
CJNE A,#07FH,NOKEY
K8: MOV DPTR,#MSG16
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG15
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG14
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG13
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG12
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG11
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG10
LCALL D_MSG
LCALL DELAY2
MOV DPTR,#MSG9
LCALL D_MSG
LCALL DELAY2
JNB P1.0,S51 
JNB P1.1,S52 
JNB P1.2,S53 
JNB P1.3,S54 
JNB P1.4,S55 
JNB P1.5,S56
JNB P1.6,S57
JNB P1.7,K8
SJMP K8
S51:LCALL KEY1 
S52:LCALL KEY2 
S53:LCALL KEY3 
S54:LCALL KEY4 
S55:LCALL KEY5 
S56:LCALL KEY6 
S57:LCALL KEY7 
NOKEY: LJMP PRESS
MSG1: DB "BE:ELEC"
MSG3: DB "::::::::12345678::::::::"
MSG4: DB "::::::::12345678::::::::"
MSG5: DB "1:3:5:7:"
MSG6: DB ":2:4:6:8"
MSG9: DB "::::::::"
MSG10: DB "4::::::5"
MSG11: DB "34::::56"
MSG12: DB "234::567"
MSG13: DB "12345678"
MSG14: DB ":123678:"
MSG15: DB "::1278::"
MSG16: DB ":::18:::"
DELAY: MOV R6,#100 ;20MS
A2: MOV R7,#100 
DJNZ R7,$
DJNZ R6,A2
RET
BLANK: MOV R0,#30H
L2: MOV @R0,#0FFH
INC R0
CJNE R0,#38H,L2
RET
DELAY2: MOV R5,#4
C2: MOV R6,#250
C1: MOV R7,#250
DJNZ R7,$
DJNZ R6,C1
DJNZ R5,C2
RET
D_MSG: MOV R0,#37H
B1: CLR A
MOVC A,@A+DPTR
CLR C
SUBB A,#30H
LCALL SEVSEG
MOV @R0,A
DEC R0
INC DPTR
CJNE R0,#2FH,B1
RET
SEVSEG:INC A
MOVC A,@A+PC 
RET
DB 0C0H;0 
DB 0CFH;1 
DB 0A4H;2
DB 0B0H;3
DB 99H;4 
DB 92H;5 
DB 82H;6
DB 0F8H;7
DB 80H;8
DB 90H;9
DB 0FFH 
DB 0FFH 
DB 0FFH 
DB 0FFH 
DB 0FFH 
DB 0FFH 
DB 0FFH
DB 88H;A
DB 80H;B
DB 0C6H;C 
DB 0A1H;D
DB 86H;E
DB 8EH;F
DB 0C2H;G
DB 89H;H
DB 0CFH;I
DB 0F1H;J 
DB 8AH;K
DB 0C7H;L
DB 0AAH;M
DB 0C8H;N
DB 0C0H;O
DB 8CH;P 
DB 98H;Q
DB 0CEH;R
DB 92H;S
DB 87H;T
DB 0C1H;U
DB 0D5H;V
DB 99H;W
DB 0B6H;X
DB 91H;Y
DB 0A4H;Z
END
